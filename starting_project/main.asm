; Adapted from https://gbdev.io/gb-asm-tutorial/part1/hello_world.html

INCLUDE "hardware.inc"

SECTION "Header", ROM0[$100]

  jp EntryPoint

  ds $150 - @, 0 ; Make room for the header

EntryPoint:
  ; Shut down audio circuitry
  xor a
  ldh [rAUDENA], a

  ; Do not turn the LCD off outside of VBlank
.wait_vblank
  ldh a, [rLY]
  cp LY_VBLANK
  jr c, .wait_vblank

  ; Turn the LCD off
  ld a, LCDC_OFF
  ldh [rLCDC], a

  ; Copy the tile data
  ld de, Tiles
  ld hl, STARTOF(VRAM) + $100 * TILE_SIZE
  ld bc, Tiles.end - Tiles
  call Copy

  ; Copy the tilemap
  ld de, Tilemap
  ld hl, TILEMAP0
  ld bc, Tilemap.end - Tilemap
  call Copy

  ; Turn the LCD on
  ld a, LCDC_ON | LCDC_BG_ON
  ldh [rLCDC], a

  ; During the first (blank) frame, initialize display registers
  ld a, %11_10_01_00
  ldh [rBGP], a

.done
  jr .done

; Subroutine to copy bc bytes from de to hl
Copy:
  ld a, [de]
  ld [hli], a
  inc de
  dec bc
  ld a, b
  or a, c
  jr nz, Copy
  ret

SECTION "Tile data", ROM0

Tiles:
  dw `22222222, `22222222, `22222222, `22222222, `22222222, `22222222, `22222222, `22222222 ; $00
  dw `22222222, `20000000, `20000000, `20000000, `20000000, `20000000, `20000000, `20000000 ; $01
  dw `22222222, `02222220, `02222220, `02222220, `02222220, `02222220, `02222220, `02222220 ; $02
  dw `22222222, `00000002, `00000002, `00000002, `00000002, `00000002, `00000002, `00000002 ; $03
  dw `22222222, `00000000, `00000000, `00000000, `00000000, `00000000, `00000000, `00000000 ; $04
  dw `22222222, `02222222, `02222222, `02222222, `02222222, `02222222, `02222222, `02222222 ; $05
  dw `22222222, `22222211, `22222000, `22220000, `22200000, `22100000, `22000000, `21000000 ; $06
  dw `22222222, `11222222, `00022222, `00002222, `00000222, `00000122, `00000022, `00000012 ; $07
  dw `20000000, `20000000, `21111111, `20000000, `20000000, `21111111, `21111111, `20000000 ; $08
  dw `02222220, `02323230, `13232321, `02323230, `03232320, `11111111, `11111111, `00000000 ; $09
  dw `00000002, `00000002, `11111113, `00000002, `00000003, `11111112, `11111113, `00000002 ; $0a
  dw `20000000, `30000000, `21111111, `30000000, `20000000, `31111111, `21111111, `30000000 ; $0b
  dw `02222222, `02323232, `13232323, `02323232, `03232323, `11111111, `11111111, `00000000 ; $0c
  dw `22222222, `32323232, `23232323, `32323232, `23232323, `11111232, `11111323, `00000232 ; $0d
  dw `02222222, `02323232, `13232323, `02323232, `03232323, `12323232, `13232323, `02323232 ; $0e
  dw `22222222, `32222222, `22222222, `32222222, `22222222, `32222222, `22222222, `32222222 ; $0f
  dw `21000000, `20000000, `21111111, `20000000, `20000000, `21111111, `21111111, `20000000 ; $10
  dw `00222200, `02222230, `12222321, `02223230, `02232320, `12323231, `12232321, `02323230 ; $11
  dw `00000012, `00000002, `11111113, `00000002, `00000003, `11111112, `11111113, `00000002 ; $12
  dw `22222222, `32222222, `23232222, `32323222, `23232222, `32323222, `23232322, `32323222 ; $13
  dw `21111111, `21111111, `21111111, `21111111, `21111111, `21111111, `21111111, `21111111 ; $14
  dw `11111111, `11111111, `11111111, `12323231, `13232321, `12323231, `13232321, `12323231 ; $15
  dw `11111113, `11111112, `11111113, `11111112, `11111113, `11111112, `11111113, `11111112 ; $16
  dw `21111111, `31111111, `21111111, `31111111, `21111111, `31111111, `21111111, `31111111 ; $17
  dw `11111111, `11111111, `11111111, `12323232, `13232323, `12323232, `13232323, `12323232 ; $18
  dw `11111222, `11111222, `11111222, `32222222, `22222222, `32323232, `23232323, `32323232 ; $19
  dw `21111111, `21111111, `21111111, `21111111, `21111111, `31111111, `21111111, `31111111 ; $1a
  dw `13232323, `12323232, `13232323, `12323232, `13232323, `12323232, `13232323, `12323232 ; $1b
  dw `13232321, `12323231, `13232321, `12323231, `13232321, `12323231, `13232321, `11323211 ; $1c
  dw `23232322, `32323232, `23232322, `32323232, `23232322, `32323232, `23232322, `32323232 ; $1d
  dw `21111111, `21111111, `21111111, `21111111, `21111111, `21111111, `21111111, `22222222 ; $1e
  dw `13232321, `12323231, `13232321, `12323231, `13232321, `12323231, `13232321, `22323232 ; $1f
  dw `11111113, `11111112, `11111113, `11111112, `11111113, `11111112, `11111113, `32222222 ; $20
  dw `21111111, `31111111, `21111111, `31111111, `21111111, `31111111, `21111111, `32323232 ; $21
  dw `11111111, `11111111, `11111111, `11111111, `11111111, `11111111, `11111111, `22323232 ; $22
  dw `11111113, `11111112, `11111113, `11111112, `11111112, `11111112, `11111112, `32222222 ; $23
  dw `21111111, `31111111, `21111111, `21111111, `21111111, `21111111, `21111111, `22222222 ; $24
  dw `11111112, `11111112, `11111112, `11111112, `11111112, `11111112, `11111112, `32222222 ; $25
  dw `22111111, `22111111, `22111111, `22211111, `22211111, `22221111, `22222211, `22222222 ; $26
  dw `11111123, `11111122, `11111123, `11111222, `11111223, `11112222, `11222223, `32222232 ; $27
  dw `23232323, `02323230, `03232320, `02323230, `03232320, `02323230, `03232320, `02222220 ; $28
  dw `22222223, `00000002, `00000003, `00000002, `00000003, `00000002, `00000003, `00000002 ; $29
  dw `23232322, `32323110, `23230000, `32300000, `23100000, `32000000, `21000000, `21000000 ; $2a
  dw `23232323, `00000000, `00000000, `00000000, `00000000, `00000000, `00000000, `00000000 ; $2b
  dw `23232323, `01123232, `00002323, `00000232, `00000323, `00000032, `00000013, `00000012 ; $2c
  dw `23232322, `30000000, `20000000, `30000000, `20000000, `30000000, `20000000, `20000000 ; $2d
  dw `23232323, `00123232, `00001323, `00000132, `00000023, `00000012, `00000003, `00000002 ; $2e
  dw `23232323, `02323232, `03232323, `02323232, `03232323, `02323232, `03232323, `02222222 ; $2f
  dw `23232323, `32323232, `23232323, `32323232, `23232323, `32323232, `23232323, `22222222 ; $30
  dw `22232323, `00000000, `00000000, `00000000, `00000000, `00000000, `00000000, `00000000 ; $31
  dw `23232323, `01123232, `00001323, `00000132, `00000023, `00000012, `00000013, `00000002 ; $32
  dw `23232322, `32323222, `23232322, `32323222, `23232222, `32322222, `23222222, `22222222 ; $33
  dw `02222220, `02323230, `13232321, `02323230, `03232320, `12321231, `13211321, `02300230 ; $34
  dw `02222200, `02323230, `13232321, `02323230, `03232300, `11111111, `11111111, `00000000 ; $35
  dw `00000002, `00000002, `11111113, `00000012, `00000113, `11111132, `11111323, `00003232 ; $36
  dw `02222200, `02323230, `13232321, `02323230, `03232320, `12323231, `13232321, `02323230 ; $37
  dw `22222222, `32322222, `23232222, `32323222, `23232322, `32323222, `23232322, `32323232 ; $38
  dw `13211121, `12111131, `13111121, `12111111, `11111111, `11111111, `11112111, `11123111 ; $39
  dw `11111111, `11111111, `11111111, `12323211, `13232321, `12323231, `13232321, `12323231 ; $3a
  dw `11111223, `11111122, `11111123, `11111112, `11111113, `11111112, `11111113, `11111112 ; $3b
  dw `13232321, `12323231, `13232321, `12323231, `13232321, `12323231, `13232321, `12323211 ; $3c
  dw `11132111, `11123211, `11232311, `11323211, `11232321, `12323231, `13232321, `22323232 ; $3d
  dw `11111113, `11111112, `11111113, `11111112, `11111113, `11111112, `11111113, `32322232 ; $3e
  dw `23111111, `32111111, `23111111, `32311111, `23211111, `32321111, `23232311, `32323232 ; $3f
  dw `11111113, `11111122, `11111123, `11111122, `11111223, `11112222, `11222223, `32222232 ; $40
  dw `23232323, `22323232, `23232323, `22323232, `23232323, `22323232, `23232323, `22222222 ; $41
  dw `23222323, `32322232, `23222223, `32222232, `23222223, `32222222, `22222223, `22222222 ; $42
  dw `23232322, `32323232, `23232322, `32323232, `23232322, `32323232, `23232322, `22222222 ; $43
  dw `22232323, `22323232, `22232323, `22223232, `22232323, `22223232, `22222223, `22222222 ; $44
  dw `22222223, `32222222, `22222223, `32222222, `22222223, `32222222, `22222223, `22222222 ; $45
.end

SECTION "Tilemap", ROM0

Tilemap:
  db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $01, $02, $03, $01, $04, $03, $01, $05, $00, $01, $05, $00, $06, $04, $07, $00, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $08, $09, $0a, $0b, $0c, $0d, $0b, $0e, $0f, $08, $0e, $0f, $10, $11, $12, $13, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $14, $15, $16, $17, $18, $19, $1a, $1b, $0f, $14, $1b, $0f, $14, $1c, $16, $1d, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $1e, $1f, $20, $21, $22, $23, $24, $22, $25, $1e, $22, $25, $26, $22, $27, $1d, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $01, $28, $29, $2a, $2b, $2c, $2d, $2b, $2e, $2d, $2f, $30, $2d, $31, $32, $33, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $08, $34, $0a, $0b, $11, $0a, $0b, $35, $36, $0b, $0e, $0f, $08, $37, $0a, $38, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $14, $39, $16, $17, $1c, $16, $17, $3a, $3b, $17, $1b, $0f, $14, $3c, $16, $1d, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $1e, $3d, $3e, $3f, $22, $27, $21, $1f, $20, $21, $22, $25, $1e, $22, $40, $1d, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $00, $41, $42, $43, $44, $30, $33, $41, $45, $43, $41, $30, $43, $41, $30, $33, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
  db $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00, $00,  0,0,0,0,0,0,0,0,0,0,0,0
.end
